"use strict";var Base=require("../base");var signals=require("signals");var format=require("../strings/format");var sys=require("lodash");var Signal=Base.compose([Base,signals.Signal],{declaredClass:"mixins/Signal",constructor:function(c,b,a){a=a||{};this.memorize=a.memorize===true;this.host=c;this.trigger=this.fire=this.raise=this.dispatch;this.name=b||sys.uniqueId("signal");this.params=a.params;this.defaultContext=a.context},destroy:function(){this.removeAll();this.dispose();this.host=null},on:function(c,b,a){if(sys.isNumber(b)){a=b;b=null}b=b||this.defaultContext||this.host;var d=this.add(c,b,a);if(this.options.params){d.params=this.arams}return d},once:function(c,b,a){if(sys.isNumber(b)){a=b;b=null}b=b||this.defaultContext||this.host;var d=this.addOnce(c,b,a);if(this.options.params){d.params=this.params}return d},off:function(b,a){a=a||this.host;return this.remove(b,a)},has:function(b,a){a=a||this.defaultContext||this.host;return this.remove(b,a)},toString:function(){return format("{0}\nname:{1}\nlisteners:{2}",this.declaredClass,this.name,this.getNumListeners())}});var Signalable=Base.compose([Base],{declaredClass:"mixins/Signalable",constructor:function(){this.autoLoadSignals=this.autoLoadSignals||true;if(this.autoLoadSignals===true){this._loadSignals()}},refreshSignals:function(){this._loadSignals()},_loadSignals:function(){var a=this.signals||{};sys.each(a,function(d,b){var c={};if(!sys.isEmpty(d)){if(sys.isBoolean(d.memorize)){c.memorize=d.memorize}if(sys.isBoolean(d.params)){c.params=d.params}if(!sys.isEmpty(d.context)){c.context=d.context}}this._addSignal(b,c)})},_addSignal:function(b,a){if(sys.isEmpty(this[b])){this[b]=new Signal(this,b,a)}},_addSignals:function(a){a=a||{};if(this.options){a=sys.extend({},sys.result(this,"signals"),a)}this.signals=a},destroy:function(){sys.each(sys.keys(this),function(a){if(this[a] instanceof Signal||this[a] instanceof signals.Signal){this[a].close()}},this)}});module.exports=Signalable;alable.Signal=Signal;Signalable.mixin=Base.mixin;