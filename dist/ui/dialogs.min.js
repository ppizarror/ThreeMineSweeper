/*
 MIT
*/
function AppDialog(){this.options={animation:{BOTTOM:"bottom",LEFT:"left",NONE:"none",OPACITY:"opacity",RIGHT:"right",ROTATE:"rotate",ROTATEX:"rotateX",ROTATEXR:"rotateXR",ROTATEY:"rotateY",ROTATEYR:"rotateYR",SCALE:"scale",SCALEX:"scaleX",SCALEY:"scaleY",TOP:"top",ZOOM:"zoom"},buttons:{BLUE:"btn-blue",DANGER:"btn-danger",DEFAULT:"btn-default",ERROR:"btn-default",INFO:"btn-info",NONE:"",OTHER:"btn-default",PRIMARY:"btn-primary",PURPLE:"btn-purple",SUCCESS:"btn-success",WARNING:"btn-warning"},icons:{ERROR:"fas fa-times",
DEFAULT:"",INFO:"fas fa-info-circle",NONE:"",OTHER:"",PURPLE:"",SUCCESS:"fas fa-check-circle",WARNING:"fas fa-exclamation-triangle"},size:{SMALL:"DIALOG-SMALL",NORMAL:"DIALOG-NORMAL",LARGE:"DIALOG-LARGE",FULL:"DIALOG-FULL"},type:{ERROR:"red",DEFAULT:"",INFO:"blue",NONE:"",OTHER:"dark",PURPLE:"purple",SUCCESS:"green",WARNING:"orange"}};this._last={destroyed:!0,md5:"",object:null,options:null};this._close_last=!1;const g=this;this.text=function(c,b,a){is_null_undf(a)&&(a={});is_null_undf(b)&&(b="");
a=$.extend({close:null,closeButtonClass:this.options.buttons.DEFAULT,closeText:lang.close_message},a);!not_null_undf(a.close)||a.close instanceof Function||(app_console.warn(lang.dialog_error_button_function_null.format(a.closeText.toUpperCase())),a.close=null);a.cancelText=null;a.onClose=a.close;a.confirmButtonClass=a.closeButtonClass;a.confirmText=a.closeText;delete a.close;delete a.closeButtonClass;delete a.closeText;this._create_dialog(b,c,a)};this.error=function(c,b,a){this._ewsio_type(c,b,this.options.type.ERROR,
this.options.icons.ERROR,this.options.buttons.ERROR,a)};this.info=function(c,b,a){this._ewsio_type(c,b,this.options.type.INFO,this.options.icons.INFO,this.options.buttons.INFO,a)};this.warning=function(c,b,a){this._ewsio_type(c,b,this.options.type.WARNING,this.options.icons.WARNING,this.options.buttons.WARNING,a)};this.other=function(c,b,a){this._ewsio_type(c,b,this.options.type.OTHER,this.options.icons.OTHER,this.options.buttons.OTHER,a)};this._ewsio_type=function(c,b,a,h,e,d){is_null_undf(d)&&(d=
{});d=$.extend({close:null,closeButtonClass:e,closeText:lang.close_message,icon:h,size:this.options.size.SMALL,type:a,typeAnimated:!0},d);!not_null_undf(d.close)||d.close instanceof Function||(app_console.warn(lang.dialog_error_button_function_null.format(d.closeText.toUpperCase())),d.close=null);d.cancelText=null;d.onClose=d.close;d.confirmButtonClass=d.closeButtonClass;d.confirmText=d.closeText;delete d.close;delete d.closeButtonClass;delete d.closeText;this._create_dialog(c,b,d)};this.confirm=
function(c,b,a){is_null_undf(a)&&(a={});a=$.extend({backgroundDismiss:!1,closeIcon:!1,draggable:!1,escapeCancelKey:!1,size:this.options.size.SMALL},a);this._create_dialog(c,b,a)};this.form=function(c,b,a,h,e){is_null_undf(e)&&(e={});is_null_undf(h)&&(h=function(){});is_null_undf(a)&&(app_console.warn(lang.dialog_form_submit_null),a=function(){});e=$.extend({backgroundDismiss:!1,cancelButtonClass:this.options.buttons.DEFAULT,cancelText:lang.dialog_form_cancel,closeIcon:!1,closeAfterSubmit:!0,escapeCancelKey:!1,
submitButtonClass:this.options.buttons.BLUE,submitText:lang.dialog_form_send},e);if(e.closeAfterSubmit){let f=a;a=function(){f();this.close()}}e.confirm=a;e.cancel=h;e.confirmButtonClass=e.submitButtonClass;e.confirmText=e.submitText;delete e.submitButtonClass;delete e.submitText;let d=function(){};not_null_undf(e.onContentReady)&&e.onContentReady instanceof Function&&(d=e.onContentReady);e.onContentReady=function(){d();let f=null,k=this;not_null_undf(k)&&k.hasOwnProperty("$content")&&(f=k.$content);
is_null_undf(f)&&(f=$(".jconfirm-content"));if(!is_null_undf(f))f.find("form").on("submit",function(l){l.preventDefault();is_null_undf(k)||k.$$confirm.trigger("click")})};this._create_dialog(c,b,e)};this._create_dialog=function(c,b,a){g._close_last&&g.close_last();a=$.extend({animateFromElement:!1,animation:this.options.animation.ZOOM,animationBounce:1,animationSpeed:400,backgroundDismiss:"cancel",buttonMaxLength:30,cancel:null,cancelButtonClass:this.options.buttons.DEFAULT,cancelText:lang.answer_no,
closeAnimation:this.options.animation.ZOOM,closeIcon:!0,confirm:null,confirmButtonClass:this.options.buttons.BLUE,confirmText:lang.answer_yes,disableSelect:!1,draggable:!1,dragWindowGap:0,escapeCancelKey:!0,forceCursorDefault:!1,icon:this.options.icons.DEFAULT,lazyOpen:!1,onClose:null,onContentReady:null,onDestroy:null,onOpen:null,onOpenBefore:null,size:this.options.size.NORMAL,type:this.options.type.DEFAULT,typeAnimated:!1,useBootstrap:!1,watchInterval:100},a);a.escapeCancelKey&&(a.escapeKey=!0,
a.escapeCancelKey="cancel");a.typeAnimated||delete a.type;is_null_undf(a.icon)&&(a.icon=this.options.icons.DEFAULT);not_null_undf(a.close)&&delete a.close;not_null_undf(a.open)&&delete a.open;a.theme=cfg_popup_theme;let h={};not_null_undf(a.confirmText)&&a.confirmText!==""&&(a.confirmText=a.confirmText.toString(),a.confirmText.length>a.buttonMaxLength&&(a.confirmText=a.confirmText.substring(0,a.buttonMaxLength-3)+"&hellip;"),!not_null_undf(a.confirm)||a.confirm instanceof Function||(app_console.warn(lang.dialog_error_button_function_null.format(a.confirmText.toUpperCase())),
a.confirm=null),h.confirm={action:a.confirm,btnClass:a.confirmButtonClass,keys:["y","enter"],text:a.confirmText});not_null_undf(a.cancelText)&&a.cancelText!==""&&(a.cancelText=a.cancelText.toString(),a.cancelText.length>a.buttonMaxLength&&(a.cancelText=a.cancelText.substring(0,a.buttonMaxLength-3)+"&hellip;"),!not_null_undf(a.cancel)||a.cancel instanceof Function||(app_console.warn(lang.dialog_error_button_function_null.format(a.cancelText.toUpperCase())),a.cancel=null),h.cancel={action:a.cancel,
btnClass:a.cancelButtonClass,keys:["n"],text:a.cancelText});a.buttons=h;not_null_undf(c)&&c!==""&&(a.title=c);not_null_undf(b)&&b!==""&&(a.content=b);!is_null_undf(a.onClose)&&a.onClose instanceof Function||(a.onClose=function(){});!is_null_undf(a.onContentReady)&&a.onContentReady instanceof Function||(a.onContentReady=function(){});!is_null_undf(a.onDestroy)&&a.onDestroy instanceof Function||(a.onDestroy=function(){});!is_null_undf(a.onOpen)&&a.onOpen instanceof Function||(a.onOpen=function(){});
!is_null_undf(a.onOpenBefore)&&a.onOpenBefore instanceof Function||(a.onOpenBefore=function(){});let e=a.onContentReady;a.onContentReady=function(){e();let f=$(".jconfirm-box");a.disableSelect&&f.addClass("noselect");a.forceCursorDefault&&f.addClass("jconfirm-default-cursor")};let d=a.onDestroy;a.onDestroy=function(){d()};g._dialog_size(a);c=$.extend({},a);delete c.boxWidth;delete c.size;c=md5(JSON.stringify(a));not_null_undf(this._last.object)&&this._last.md5===c&&!this._last.object.isClosed()&&
(app_console.info(lang.dialog_last_closed_equal_opened),g.close_last());b=$.confirm(a);app_console.info(lang.dialog_popup_created.format(c));this._last.md5=c;this._last.$options=a;this._last.object=b};this._dialog_size=function(c){let b=get_element_width(app_dom.window);switch(c.size){case this.options.size.SMALL:c.boxWidth=b<=350?"95%":b<=400?"57%":b<=500?"53%":b<=600?"48%":b<=700?"43%":b<=800?"38%":b<=900?"35%":b<=1E3?"31%":"30%";break;case this.options.size.NORMAL:c.boxWidth=b<=350?"95%":b<=400?
"67%":b<=500?"60%":b<=600?"58%":b<=700?"54%":b<=800?"50%":b<=900?"46%":b<=1E3?"44%":"37%";break;case this.options.size.LARGE:c.boxWidth=b<=350?"95%":b<=400?"85%":b<=500?"78%":b<=600?"74%":b<=700?"71%":b<=800?"67%":b<=900?"63%":b<=1E3?"60%":"55%";break;case this.options.size.FULL:c.boxWidth="95%";break;default:app_console.warn(lang.app_dialog_unknown_size.format(c.size)),c.useBootstrap=!0,delete c.size}};this.close_last=function(){not_null_undf(g._last.object)&&g._last.object.close()};this.open_last=
function(){not_null_undf(g._last.object)&&g._last.object.open()};this.enable_close_last=function(){g._close_last=!0}}const app_dialog=new AppDialog;app_dialog.enable_close_last();
