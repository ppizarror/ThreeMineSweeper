/*
 MIT
*/
function ThreeMineSweeper(){this._menu=this._mines=this._viewer=this._events=null;this._generator={facetarget:null,fun:"",item:"",latitude:null,longitude:null,mines:0,order:null,type:0};var b=this;this.init=function(a){b._viewer=new TMSViewer;b._events=new TMSEvents;b._mines=new Minesweeper;b._menu=new TMSMenu;b._viewer.init(a);b._events.set_viewer(b._viewer);b._events.set_minesweeper(b._mines);b._events.initEvents();!cfg_verbose&&cfg_reload_alert_onclose&&setTimeout(function(){window.onbeforeunload=
function(){return lang.reload_alert}},500);b._menu.init_menu()};this.set_generator=function(a,b,c,e,f,g,h){this._generator.type=a;this._generator.facetarget=c;this._generator.fun=g;this._generator.item=h;this._generator.latitude=e;this._generator.longitude=f;this._generator.order=b};this.set_mines=function(a){this._generator.mines=a};this._generate=function(){switch(this._generator.type){case 0:var a=new GenBasicCube;break;case 1:a=new GenBasicPyramid;break;case 2:a=new GenCrossFractal;break;case 3:a=
new GenSierpinskiCube;break;case 4:a=new GenSierpinskiTriangle;break;case 5:a=new GenRandomPlane;break;case 6:a=new GenSphere;break;case 7:a=new GenCylinder;break;case 8:a=new GenSquare;break;case 9:a=new GenCube;break;case 10:a=new GenToroid;break;case 11:a=new GenFunction;break;case 12:a=new GenMobius;break;case 13:a=new GenPolyhedra;break;default:a=new GenEmpty}not_null_undf(this._generator.facetarget)&&a.set_face_target(this._generator.facetarget);not_null_undf(this._generator.fun)&&a.set_function(this._generator.fun);
not_null_undf(this._generator.item)&&a.set_item(this._generator.item);not_null_undf(this._generator.latitude)&&a.set_latitude(this._generator.latitude);not_null_undf(this._generator.longitude)&&a.set_longitude(this._generator.longitude);not_null_undf(this._generator.order)&&a.set_order(this._generator.order);a.generate(-1,-1,-1,1,1,1);a.set_type_id(this._generator.type);return a};this.abort=function(){b._viewer.delete_last_volume();b._mines.reset_game_ui();app_console.info(lang.reset_game);app_sound.stop_all()};
this.load_menu=function(){b.abort();b._menu.main_menu()};this.new=function(){b.abort();loadingHandler(!0);setTimeout(function(){var a=b._generate(),d=a.get_volume(),c=a.get_camera();b._mines.new(d,b._generator.mines,a.get_genid(),a.get_name(),a.get_type_id())?(b._events.set_volume(d),b._viewer.set_camera_pos(c.x,c.y,c.z),b._viewer.new(d),b._mines.new_game_ui(!0),b._viewer.focus(),loadingHandler(!1)):(loadingHandler(!1),app_dialog.confirm(lang.error_message,lang.new_game_bad_volume,{cancelText:null,
confirmButtonClass:app_dialog.options.buttons.DANGER,confirmText:lang.answer_ok,icon:"fas fa-exclamation-triangle"}),b.load_menu())},450)}};
