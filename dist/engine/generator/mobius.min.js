/*
 MIT
*/
function GenMobius(){Generator.call(this);this._genprops.latlng=!0;this._set_name("Moebius");this._generate=function(f,b,g,x,d,c){this._set_camera_position(0,0,2);let h=this._lat+1,p=this._lng+1;var m=Math.abs(x-f),u=Math.abs(d-b),y=Math.abs(c-g),r=Math.min(m,u)/2;f=(f+x)/2;b=(b+d)/2;c=(g+c)/2;d=2*Math.PI/(p-1);x=2*r/(h-1);g=[];let k,l;let n,F=function(q,v){return(1+v/2*Math.cos(q/2))*Math.cos(q)},G=function(q,v){return(1+v/2*Math.cos(q/2))*Math.sin(q)};var z=1,A=1,B=1,w=Number.NEGATIVE_INFINITY,
e=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY,H=Number.POSITIVE_INFINITY,I=Number.NEGATIVE_INFINITY,J=Number.POSITIVE_INFINITY,C=1,D=1,E=1,K=Number.NEGATIVE_INFINITY,L=Number.POSITIVE_INFINITY,M=Number.NEGATIVE_INFINITY,N=Number.POSITIVE_INFINITY,O=Number.NEGATIVE_INFINITY,P=Number.POSITIVE_INFINITY;for(let q=0;q<p;q+=1){n=q*d;for(let v=0;v<h;v+=1){var a=-r+x*v;k=f+F(n,a);l=b+G(n,a);a=c+a/2*Math.sin(n/2);k>=f?(w=Math.max(w,k),e=Math.min(e,k)):(K=Math.max(K,k),L=Math.min(L,k));l>=b?(t=Math.max(t,
l),H=Math.min(H,l)):(M=Math.max(M,l),N=Math.min(N,l));a>=c?(I=Math.max(I,a),J=Math.min(J,a)):(O=Math.max(O,a),P=Math.min(P,a))}}z=Math.min(z,m/(2*Math.abs(w-e)));A=Math.min(A,u/(2*Math.abs(t-H)));B=Math.min(B,y/(2*Math.abs(I-J)));C=Math.min(C,m/(2*Math.abs(K-L)));D=Math.min(D,u/(2*Math.abs(M-N)));E=Math.min(E,y/(2*Math.abs(O-P)));for(m=0;m<p;m+=1)for(n=m*d,e=0;e<h;e+=1)a=-r+x*e,k=F(n,a),l=G(n,a),a=a/2*Math.sin(n/2),u=k>=f?z:C,y=l>=b?A:D,w=a>=c?B:E,k*=u,l*=y,a*=w,g.push(new Vertex(f+k,b+l,c+a,"Vs"+
(m*p+e).toString()));m=g.length;for(e=0;e<p;e+=1)for(n=e*d,t=0;t<h;t+=1)a=-r+x*t,k=F(n,a),l=G(n,a),a=a/2*Math.sin(n/2)-.005*(e===0||e===p-1?0:1),u=k>=f?z:C,y=l>=b?A:D,w=a>=c?B:E,k*=u,l*=y,a*=w,g.push(new Vertex(f+k,b+l,c+a,"Vi"+(e*p+t).toString()));r=[];f=1;for(c=0;c<p-1;c+=1)for(d=0;d<h-1;d+=1)b=new Face([g[h*c+d],g[h*c+d+1],g[h*(c+1)+d+1],g[h*(c+1)+d]],"Fs"+f.toString()),b.enable_uv_flip(),b.set_uv_rotation(-90),b.disable_contour(),b.set_bomb_behaviour(b.behaviour.AROUND),r.push(b),f+=1;for(c=0;c<
p-1;c+=1)for(d=0;d<h-1;d+=1)b=new Face([g[m+h*c+d],g[m+h*c+d+1],g[m+h*(c+1)+d+1],g[m+h*(c+1)+d]],"Fi"+f.toString()),b.reverse_vertices(),b.set_uv_rotation(-90),b.disable_contour(),b.set_bomb_behaviour(b.behaviour.AROUND),r.push(b),f+=1;this._volume.add_face(r);this._volume.disable_contour()}};
