/*
 MIT
*/
function GenMobius(){Generator.call(this);this._genprops.latlng=!0;this._set_name("Moebius");this._generate=function(f,b,g,v,d,c){this._set_camera_position(0,0,2);var h=this._lat+1,p=this._lng+1,m=Math.abs(v-f),t=Math.abs(d-b),w=Math.abs(c-g),q=Math.min(m,t)/2;f=(f+v)/2;b=(b+d)/2;c=(g+c)/2;d=2*Math.PI/(p-1);v=2*q/(h-1);g=[];for(var k,l,a,n,F=function(x,E){return(1+E/2*Math.cos(x/2))*Math.cos(x)},G=function(x,E){return(1+E/2*Math.cos(x/2))*Math.sin(x)},y=1,z=1,A=1,u=Number.NEGATIVE_INFINITY,e=Number.POSITIVE_INFINITY,
r=Number.NEGATIVE_INFINITY,H=Number.POSITIVE_INFINITY,I=Number.NEGATIVE_INFINITY,J=Number.POSITIVE_INFINITY,B=1,C=1,D=1,K=Number.NEGATIVE_INFINITY,L=Number.POSITIVE_INFINITY,M=Number.NEGATIVE_INFINITY,N=Number.POSITIVE_INFINITY,O=Number.NEGATIVE_INFINITY,P=Number.POSITIVE_INFINITY,Q=0;Q<p;Q+=1){n=Q*d;for(var R=0;R<h;R+=1)a=-q+v*R,k=f+F(n,a),l=b+G(n,a),a=c+a/2*Math.sin(n/2),k>=f?(u=Math.max(u,k),e=Math.min(e,k)):(K=Math.max(K,k),L=Math.min(L,k)),l>=b?(r=Math.max(r,l),H=Math.min(H,l)):(M=Math.max(M,
l),N=Math.min(N,l)),a>=c?(I=Math.max(I,a),J=Math.min(J,a)):(O=Math.max(O,a),P=Math.min(P,a))}y=Math.min(y,m/(2*Math.abs(u-e)));z=Math.min(z,t/(2*Math.abs(r-H)));A=Math.min(A,w/(2*Math.abs(I-J)));B=Math.min(B,m/(2*Math.abs(K-L)));C=Math.min(C,t/(2*Math.abs(M-N)));D=Math.min(D,w/(2*Math.abs(O-P)));for(m=0;m<p;m+=1)for(n=m*d,e=0;e<h;e+=1)a=-q+v*e,k=F(n,a),l=G(n,a),a=a/2*Math.sin(n/2),t=k>=f?y:B,w=l>=b?z:C,u=a>=c?A:D,k*=t,l*=w,a*=u,g.push(new Vertex(f+k,b+l,c+a,"Vs"+(m*p+e).toString()));m=g.length;for(e=
0;e<p;e+=1)for(n=e*d,r=0;r<h;r+=1)a=-q+v*r,k=F(n,a),l=G(n,a),a=a/2*Math.sin(n/2)-.005*(0===e||e===p-1?0:1),t=k>=f?y:B,w=l>=b?z:C,u=a>=c?A:D,k*=t,l*=w,a*=u,g.push(new Vertex(f+k,b+l,c+a,"Vi"+(e*p+r).toString()));q=[];f=1;for(c=0;c<p-1;c+=1)for(d=0;d<h-1;d+=1)b=new Face([g[h*c+d],g[h*c+d+1],g[h*(c+1)+d+1],g[h*(c+1)+d]],"Fs"+f.toString()),b.enable_uv_flip(),b.set_uv_rotation(-90),b.disable_contour(),b.set_bomb_behaviour(b.behaviour.AROUND),q.push(b),f+=1;for(c=0;c<p-1;c+=1)for(d=0;d<h-1;d+=1)b=new Face([g[m+
h*c+d],g[m+h*c+d+1],g[m+h*(c+1)+d+1],g[m+h*(c+1)+d]],"Fi"+f.toString()),b.reverse_vertices(),b.set_uv_rotation(-90),b.disable_contour(),b.set_bomb_behaviour(b.behaviour.AROUND),q.push(b),f+=1;this._volume.add_face(q);this._volume.disable_contour()}};
