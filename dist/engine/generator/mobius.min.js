/*
 MIT
*/
function GenMobius(){Generator.call(this);this._genprops.latlng=!0;this._set_name("Moebius");this._generate=function(f,b,g,v,d,c){this._set_camera_position(0,0,2);var h=this._lat+1,p=this._lng+1,m=Math.abs(v-f),t=Math.abs(d-b),w=Math.abs(c-g),q=Math.min(m,t)/2;f=(f+v)/2;b=(b+d)/2;c=(g+c)/2;d=2*Math.PI/(p-1);v=2*q/(h-1);g=[];for(var k,l,a,n,D=function(a,b){return(1+b/2*Math.cos(a/2))*Math.cos(a)},E=function(a,b){return(1+b/2*Math.cos(a/2))*Math.sin(a)},x=1,y=1,z=1,u=Number.NEGATIVE_INFINITY,e=Number.POSITIVE_INFINITY,
r=Number.NEGATIVE_INFINITY,F=Number.POSITIVE_INFINITY,G=Number.NEGATIVE_INFINITY,H=Number.POSITIVE_INFINITY,A=1,B=1,C=1,I=Number.NEGATIVE_INFINITY,J=Number.POSITIVE_INFINITY,K=Number.NEGATIVE_INFINITY,L=Number.POSITIVE_INFINITY,M=Number.NEGATIVE_INFINITY,N=Number.POSITIVE_INFINITY,O=0;O<p;O+=1){n=O*d;for(var P=0;P<h;P+=1)a=-q+v*P,k=f+D(n,a),l=b+E(n,a),a=c+a/2*Math.sin(n/2),k>=f?(u=Math.max(u,k),e=Math.min(e,k)):(I=Math.max(I,k),J=Math.min(J,k)),l>=b?(r=Math.max(r,l),F=Math.min(F,l)):(K=Math.max(K,
l),L=Math.min(L,l)),a>=c?(G=Math.max(G,a),H=Math.min(H,a)):(M=Math.max(M,a),N=Math.min(N,a))}x=Math.min(x,m/(2*Math.abs(u-e)));y=Math.min(y,t/(2*Math.abs(r-F)));z=Math.min(z,w/(2*Math.abs(G-H)));A=Math.min(A,m/(2*Math.abs(I-J)));B=Math.min(B,t/(2*Math.abs(K-L)));C=Math.min(C,w/(2*Math.abs(M-N)));for(m=0;m<p;m+=1)for(n=m*d,e=0;e<h;e+=1)a=-q+v*e,k=D(n,a),l=E(n,a),a=a/2*Math.sin(n/2),t=k>=f?x:A,w=l>=b?y:B,u=a>=c?z:C,k*=t,l*=w,a*=u,g.push(new Vertex(f+k,b+l,c+a,"Vs"+(m*p+e).toString()));m=g.length;for(e=
0;e<p;e+=1)for(n=e*d,r=0;r<h;r+=1)a=-q+v*r,k=D(n,a),l=E(n,a),a=a/2*Math.sin(n/2)-.005*(0===e||e===p-1?0:1),t=k>=f?x:A,w=l>=b?y:B,u=a>=c?z:C,k*=t,l*=w,a*=u,g.push(new Vertex(f+k,b+l,c+a,"Vi"+(e*p+r).toString()));q=[];f=1;for(c=0;c<p-1;c+=1)for(d=0;d<h-1;d+=1)b=new Face([g[h*c+d],g[h*c+d+1],g[h*(c+1)+d+1],g[h*(c+1)+d]],"Fs"+f.toString()),b.enable_uv_flip(),b.set_uv_rotation(-90),b.disable_contour(),b.set_bomb_behaviour(b.behaviour.AROUND),q.push(b),f+=1;for(c=0;c<p-1;c+=1)for(d=0;d<h-1;d+=1)b=new Face([g[m+
h*c+d],g[m+h*c+d+1],g[m+h*(c+1)+d+1],g[m+h*(c+1)+d]],"Fi"+f.toString()),b.reverse_vertices(),b.set_uv_rotation(-90),b.disable_contour(),b.set_bomb_behaviour(b.behaviour.AROUND),q.push(b),f+=1;this._volume.add_face(q);this._volume.disable_contour()}};
