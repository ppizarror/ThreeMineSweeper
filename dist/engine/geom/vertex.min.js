/*
 MIT
*/
function Vertex(g,h,k,l){is_null_undf(g)&&(g=0);is_null_undf(h)&&(h=0);is_null_undf(k)&&(k=0);this._id=generateID();this._faces=[];this._name="";const m=this;this._position=new THREE.Vector3(g,h,k);this.prev=function(a){for(let b=0;b<this._faces.length;b+=1)if(this._faces[b].equals(a))return this._faces[b].get_prev_vertex(this);return null};this.next=function(a){for(let b=0;b<this._faces.length;b+=1)if(this._faces[b].equals(a))return this._faces[b].get_next_vertex(this);return null};this.get_id=function(){return this._id};
this.set_name=function(a){is_null_undf(a)||(m._name=a.toString())};this.get_name=function(){return this._name};this.add_face=function(a){if(a instanceof Array){var b=!0;for(let c=0;c<a.length;c+=1)b=b&&this.add_face(a[c]);return b}for(b=0;b<this._faces.length;b+=1)if(this._faces[b].equals(a))return!1;this._faces.push(a);return!0};this.has_face=function(a){if(a instanceof Array){for(var b=0;b<a.length;b+=1)if(!this.has_face(a[b]))return!1;return!0}for(b=0;b<this._faces.length;b+=1)if(this._faces[b].equals(a))return!0;
return!1};this.remove_face=function(a){if(a instanceof Array)for(var b=0;b<a.length;b+=1)this.remove_face(a[b]);else for(b=0;b<this._faces.length;b+=1)if(this._faces[b].equals(a)){this._faces.splice(b,1);break}};this.get_pos=function(a){return a?new THREE.Vector3(this.get_y(),this.get_z(),this.get_x()):this._position.clone()};this.get_x=function(){return this._position.getComponent(0)};this.get_y=function(){return this._position.getComponent(1)};this.get_z=function(){return this._position.getComponent(2)};
this.set_x=function(a){this._position.setX(a)};this.set_y=function(a){this._position.setY(a)};this.set_z=function(a){this._position.setZ(a)};this.dist=function(a){return is_null_undf(a)?(a=new THREE.Vector3(0,0,0),this._position.distanceTo(a)):this._position.distanceTo(a.get_pos())};this.equals=function(a){return this._id===a.get_id()};this.add=function(a){this._position.add(a._position)};this.subtract=function(a){a=a._position.clone();a.negate();this._position.add(a)};this.is_zero=function(){return this.dist()<
MIN_TOL};this.close_to=function(a){return this.dist(a)<MIN_TOL};this.ccw=function(a,b){if(this.equals(a)||this.equals(b))return!1;let c=a.get_x()-this.get_x(),d=a.get_y()-this.get_y();a=a.get_z()-this.get_z();let e=b.get_x()-this.get_x(),f=b.get_y()-this.get_y();b=b.get_z()-this.get_z();return!(d*b-f*a>0||c*b-e*a>0||c*f-e*d>0)};this.collinear=function(a,b){return this.equals(a)||this.equals(b)?!1:this.area2(a,b)===0};this.area2=function(a,b){if(this.equals(a)||this.equals(b))return 0;let c=a.get_x()-
this.get_x(),d=a.get_y()-this.get_y();a=a.get_z()-this.get_z();let e=b.get_x()-this.get_x(),f=b.get_y()-this.get_y();b=b.get_z()-this.get_z();return Math.sqrt(Math.pow(d*b-f*a,2)+Math.pow(c*b-e*a,2)+Math.pow(c*f-e*d,2))*.5};this.scale=function(a,b,c,d){is_null_undf(b)&&(b=1);is_null_undf(c)&&(c=1);is_null_undf(d)&&(d=1);this.set_x(this.get_x()*a*b);this.set_y(this.get_y()*a*c);this.set_z(this.get_z()*a*d)};this.translate=function(a,b,c){is_null_undf(a)&&(a=0);is_null_undf(b)&&(b=0);is_null_undf(c)&&
(c=0);this.set_x(this.get_x()+a);this.set_y(this.get_y()+b);this.set_z(this.get_z()+c)};this.print=function(){app_console.info("Vertex <{0}> at ({1},{2},{3})".format(this._name,this.get_x(),this.get_y(),this.get_z()))};this.get_faces=function(a){return a?this._faces.slice(0):this._faces};this.total_faces=function(){return this._faces.length};this.equal_position=function(a){return this._eq_pos(this.get_x(),a.get_x())&&this._eq_pos(this.get_y(),a.get_y())&&this._eq_pos(this.get_z(),a.get_z())};this._eq_pos=
function(a,b){return Math.abs(a-b)<MIN_TOL};this.join_replace=function(a){if(!this.equal_position(a))return!1;this.set_name(a.get_name());let b=a.get_faces(!0);for(let c=0;c<b.length;c+=1)this.add_face(b[c]),a.remove_face(b[c]),b[c].replace_vertex(a,this);return!0};this.set_name(l)};
